{
    "collab_server" : "",
    "contents" : "           ######### APPLIED STATISTICS -> EXERCISE 8 (continuation of Exercise 7) #######\n\n\nrm(list=ls())                    ### Quasi-multicollinearity ###           \nlibrary(readxl)\nread_excel(\"Data\\\\Cars_raw.xls\",sheet=1)\ndataM=as.data.frame(read_excel(\"Data\\\\Cars_raw.xls\",sheet=2)) # data for modelling\n# dataM=read.csv(\"Data\\\\Cars_raw_M.csv\",sep = \";\")\ncorTable=cor(dataM)\n\nmodel2=lm(Y~X2+X4,data = dataM)\nsummary(model2)\n\nQMC_X10=lm(X10~X2+X4,data = dataM)\nsummary(QMC_X10)\nmodel3=lm(Y~X2+X4+X10,data = dataM)\nsummary(model3)\n\nQMC_X1=lm(X1~X2+X4+X10,data = dataM)\nsummary(QMC_X1)\nmodel4=lm(Y~X2+X4+X10+X1,data = dataM)\nsummary(model4)\n\nQMC_X3=lm(X3~X2+X4+X10,data = dataM)\nsummary(QMC_X3)\nmodel5=lm(Y~X2+X4+X10+X3,data = dataM)\nsummary(model5)\n\nQMC_X5=lm(X5~X2+X4+X10+X3,data = dataM)\nsummary(QMC_X5)\nmodel6=lm(Y~X2+X4+X10+X3+X5,data = dataM)\nsummary(model6)\n\nQMC_X8=lm(X8~X2+X4+X10+X3+X5,data = dataM)\nsummary(QMC_X8)\nmodel7=lm(Y~X2+X4+X10+X3+X5+X8,data = dataM)\nsummary(model7)\n\nQMC_X7=lm(X7~X2+X4+X10+X3+X5,data = dataM)\nsummary(QMC_X7)\n\nQMC_X9=lm(X9~X2+X4+X10+X3+X5,data = dataM)\nsummary(QMC_X9)\nmodel8=lm(Y~X2+X4+X10+X3+X5+X9,data = dataM)\nsummary(model8)\n\nQMC_X6=lm(X6~X2+X4+X10+X3+X5+X9,data = dataM)\nsummary(QMC_X6)\nmodel9=lm(Y~X2+X4+X10+X3+X5+X9+X6,data = dataM)\nsummary(model9)\n\nmodel=lm(Y~X2+X4+X10+X3+X5+X9,data = dataM)\nsummary(model)\nplot(model)\n# Check the assumptions of the model\n\n                                            ### Predictions ###\n\nse=sqrt(deviance(model)/df.residual(model))\nse                  # standard error\nrse=se/mean(dataM$Y)\nrse                 # realtive standard error\n\ndataP=as.data.frame(read_excel(\"Data\\\\Cars_raw.xls\",sheet=3)) # data for modelling\n# dataP=read.csv(\"Data\\\\Cars_raw_P.csv\",sep = \";\")\npredict(model, int=\"p\", newdata=dataP)\nY_predicted=predict(model, newdata=dataP)\n\nMAE=mean(abs(dataP$Y-Y_predicted))  # Mean Absolute Error\nMSE=mean((dataP$Y-Y_predicted)^2)   # Mean Squared Error\nRMSE=sqrt(MSE)                      # Root Mean Squared Error\nMAE; RMSE\n\nMARE=mean(abs((dataP$Y-Y_predicted)/dataP$Y))  # Mean Absolute Relative Error\nMSRE=mean(((dataP$Y-Y_predicted)/dataP$Y)^2)  # Mean Squared Relative Error\nRMSRE=sqrt(MSRE)                              # Root Mean Squared Relative Error\nMARE; RMSRE\n\nPMAE=MAE/mean(dataP$Y)      # Percentage Mean Absolute Error\nPRMSE=RMSE/mean(dataP$Y)    # Percentage Root Mean Squared Error\nPMAE; PRMSE\n\nTheil_coeff=sqrt(mean((dataP$Y-Y_predicted)^2))/sqrt(mean((dataP$Y)^2)+mean((Y_predicted)^2))\n\ncor.test(Y_predicted,dataP$Y)\n\nplot(dataP$Y, Y_predicted, pch=21,cex=1.5,bg=rgb(1/3,1/3,1/3))\nabline(lm(dataP$Y~Y_predicted), col=rgb(220/255,0,0), lwd=3)\nsummary(lm(dataP$Y~Y_predicted))\n\nplot(dataP$Y, Y_predicted, pch=21,cex=1.5,bg=rgb(1/3,1/3,1/3))\nabline(lm(dataP$Y~Y_predicted-1), col=rgb(220/255,0,0), lwd=3)\nsummary(lm(dataP$Y~Y_predicted-1))\n#################################################################################################\n\nrm(list=ls())                          \nAdvertising=read.csv(\"Data\\\\Advertising.csv\",sep = \",\",colClasses=c(\"NULL\",NA,NA,NA,NA))\nstr(Advertising)\n\n                                              #### Задача 4 ####\n# Като изплозвате данните 'Advertising' по-горе, отговорете на следните въпроси:\n# а) Има ли зависимост между продажбите и бюджета за реклама?\n# б) Колко силна е тази зависимост?\n# в) Линейна ли е зависимостта?\n# г) Кои медии допринасят за увеличение на продажбите?\n# д) Колко голям е ефектът на всяка от медиите върху продажбите?\n# е) С каква точност могат да се предскажат бъдещите продажби?\n# ж) Подходящо ли е използването на неадитивен модел?\n\n\n",
    "created" : 1524031212515.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2836623244",
    "id" : "8ABEF44B",
    "lastKnownWriteTime" : 1524035117,
    "last_content_update" : 1524035117901,
    "path" : "C:/Stuffs/books/Acer_math/PS/Exercise_8/Script_exercise_8.R",
    "project_path" : "Script_exercise_8.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}