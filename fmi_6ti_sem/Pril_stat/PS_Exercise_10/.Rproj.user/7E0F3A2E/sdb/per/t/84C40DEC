{
    "collab_server" : "",
    "contents" : "                             ######### APPLIED STATISTICS -> EXERCISE 10 #######\n\n\nrm(list=ls())                       ### Linear Discriminant Analysis ###  \n                  \n                                        # Simulated example of LDA #\n# install.packages(\"MASS\")\nlibrary(\"MASS\")\n\n# generate data\nset.seed(1)\n\ngroupN=100 # number of cases per group\ngroup1x=rnorm(n = groupN, mean = 0, sd = 4)\ngroup1y=rnorm(n = groupN, mean = 0, sd = 4)\ngroup2x=rnorm(n = groupN, mean = 10, sd = 5)\ngroup2y=rnorm(n = groupN, mean = 10, sd = 5)\n\ngroup1=data.frame(x = group1x, y = group1y, group = \"A\")\ngroup2=data.frame(x = group2x, y = group2y, group = \"B\")\nsimData=rbind(group1, group2)\n\n# LDA\nsimModel=lda(group ~ x + y, data = simData)\nsimModel\nplot(simModel)\n\n#scatterplot\nplot(simData[,1:2], col = simData[,3])\npoints(simModel$means, pch = \"+\", cex = 3, col = c(\"black\", \"red\"))\n\n# draw discrimination line\npredN=1000\nnewDataX <- seq(from = min(simData$x), to = max(simData$x), length.out = predN)\nnewDataY <- seq(from = min(simData$y), to = max(simData$y), length.out = predN)\nnewData <- expand.grid(x = newDataX, y = newDataY)\npredData <- as.numeric(predict(simModel, newdata = newData)$class)\ncontour(x = newDataX, y = newDataY, z = matrix(predData, nrow = predN, ncol = predN), \n        levels = c(1, 2), add = TRUE, drawlabels = FALSE)\n\n                                          # The Stock Market Data #\n# install.packages(\"ISLR\")\nlibrary(ISLR)\n\nstr(Smarket)\n?Smarket\nedit(Smarket)\nsummary(Smarket)\nplot(Smarket)\ncor(Smarket) # WRONG! -> Factor variable\ncor(Smarket[,-9])\nplot(Smarket$Volume)\n                                              ### LDA for Smarket ###\n\nattach(Smarket)\ntrain=(Year<2005)\nSmarket2005=Smarket[!train,]\nDirection2005=Direction[!train]\n\nldaModel=lda(Direction~Lag1+Lag2,data=Smarket,subset=train)\nldaModel\nsummary(ldaModel)\nplot(ldaModel)\nplot(x=Lag1,y=Lag2, col = Direction)\npoints(ldaModel$means, pch = \"+\", cex = 3, col = c(\"black\", \"red\"))\n\nldaPred=predict(ldaModel, Smarket[train,])\nldaClass=ldaPred$class\ntable(ldaClass,Direction[train])\n\nldaPred2005=predict(ldaModel, Smarket2005)\nnames(ldaPred2005)\nstr(ldaPred2005)\n\nldaClass2005=ldaPred2005$class\ntable(ldaClass2005,Direction2005)\nmean(ldaClass==Direction2005)\n\nsum(ldaPred2005$posterior[,1]>=.5)\nsum(ldaPred2005$posterior[,1]<.5)\nldaPred2005$posterior[1:20,1]\nldaClass2005[1:20]\nsum(ldaPred2005$posterior[,1]>.7)\nsummary(ldaPred2005$posterior)\ndetach(Smarket)\n\n                                                  ### IRIS dataset ###\n# install.packages(\"MASS\")\nlibrary(\"MASS\")\ndata(\"iris\")\nstr(iris)\nboxplot(iris[which(iris$Species==\"setosa\"),1:4])\nboxplot(iris[which(iris$Species==\"versicolor\"),1:4])\nboxplot(iris[which(iris$Species==\"virginica\"),1:4])\nmodel1=lda(Species~.,data=iris)\nmodel1\n\nmodel2=lda(Species~Sepal.Length+Sepal.Width,data=iris)\nmodel2\n#scatterplot\nplot(x=iris$Sepal.Length,iris$Sepal.Width, col = iris$Species)\npoints(model2$means, pch = \"+\", cex = 3, col = c(1,2,3))\n\n# draw discrimination line\npredN=1000\nnewDataX <- seq(from = min(iris$Sepal.Length), to = max(iris$Sepal.Length), length.out = predN)\nnewDataY <- seq(from = min(iris$Sepal.Width), to = max(iris$Sepal.Width), length.out = predN)\nnewData <- expand.grid(Sepal.Length = newDataX, Sepal.Width = newDataY)\npredData <- as.numeric(predict(model2, newdata = newData)$class)\ncontour(x = newDataX, y = newDataY, z = matrix(predData, nrow = predN, ncol = predN), \n        levels = c(1,2,3), add = TRUE, drawlabels = FALSE)\n\n                                                      #### Задача 1 ####\n# Като изплозвате данните 'Default' от пакета 'ISLR', конструирайте линеен дискриминантен модел за\n# предсказване на променливата 'default'. Какви изводи може да нправите?\n",
    "created" : 1525238288051.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2492425015",
    "id" : "84C40DEC",
    "lastKnownWriteTime" : 1525246756,
    "last_content_update" : 1525246756281,
    "path" : "C:/Stuffs/books/Acer_math/PS/Exercise_10/Script_exercise_10.R",
    "project_path" : "Script_exercise_10.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}